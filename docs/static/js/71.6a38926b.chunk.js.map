{"version":3,"sources":["redux/actions/dashBoardActions.js","pages/dashboard/index.js"],"names":["client","Client","setIndexResultActions","key","dispatch","call","uri","method","data","sort","endTime","order","then","response","type","SET_INDEX_RESULT","payload","catch","err","console","error","useStyles","makeStyles","theme","headerField","fontSize","fontWeight","headerValue","primaryShard","border","replicaShard","margin","spacing","paper","padding","textAlign","color","palette","text","secondary","BorderLinearProgress","withStyles","root","height","backgroundColor","lighten","bar","borderRadius","LinearProgress","Card","styled","MuiCard","sizing","Divider","MuiDivider","Grid","MuiGrid","TableRow","MuiTableRow","TableCell","MuiTableCell","getFinishTime","Button","startTime","estimatedTime","Date","getTime","valueOf","untilTime","time","hours","h","Math","floor","m","month","ceil","d","WarningIndex","status","indices","history","useHistory","list","Object","values","map","row","health","uuid","forEach","item","index","push","CardContent","Typography","variant","gutterBottom","display","Table","TableBody","length","align","Box","justifyContent","alignItems","style","marginRight","Link","cursor","onClick","colSpan","RunningIndex","result","running","classes","indexList","Map","successIndexList","hits","_source","keyList","keys","server","undefined","docSize","width","mr","className","value","Number","minWidth","minutes","getElapsed","TopArea","container","xs","BottomArea","alias","resultList","aliasName","row2","storage","store","Fragment","mt","overflow","TableHead","marginLeft","date","getFullYear","getMonth","slice","getDate","getHours","getMinutes","getSeconds","format","num","toString","replace","connect","dashBoardReducers","useEffect","setInterval","SET_RUNNING_INDEX","SET_INDEX_STATUS","SET_INDEX_ALIAS","params","SET_DASHBOARD_INDICES_INFO","title","my"],"mappings":"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","file":"static/js/71.6a38926b.chunk.js","sourcesContent":["import { SET_INDEX_RESULT, SET_RUNNING_INDEX, SET_INDEX_STATUS, SET_INDEX_ALIAS, SET_DASHBOARD_INDICES_INFO } from \"../constants\";\r\nimport Client from '~/Client'\r\n\r\nconst client = new Client()\r\n\r\nexport const setIndexResultActions = key => dispatch => client.call({\r\n  uri: `/elasticsearch/.dsearch_index_history/_search`,\r\n  method: 'post',\r\n  data: {\r\n    \"query\": {\r\n      \"bool\": {\r\n        \"minimum_should_match\": 1,\r\n        \"should\": [\r\n          {\r\n            \"term\": {\r\n              \"jobType\": \"FULL_INDEX\"\r\n            }\r\n          },\r\n          {\r\n            \"term\": {\r\n              \"jobType.keyword\": \"FULL_INDEX\"\r\n            }\r\n          }\r\n        ]\r\n      }\r\n    },\r\n    sort: [\r\n      {\r\n        endTime: {\r\n          order: \"desc\"\r\n        }\r\n      }\r\n    ]\r\n    // ,\r\n    // collapse: {\r\n    //   field: \"index\",\r\n    //   inner_hits: {\r\n    //     name: \"_bundle\",\r\n    //     size: 0\r\n    //   }\r\n    // }\r\n  }\r\n})\r\n  .then(response => dispatch({ type: SET_INDEX_RESULT, payload: response.data }))\r\n  .catch(err => console.error(err))\r\n\r\n// export const setRunningIndexActions = key => dispatch => client.call({uri: `/elasticsearch/.dsearch_last_index_status/_search?q=status:RUNNING`})\r\n//     .then(response => dispatch({type: SET_RUNNING_INDEX, payload: response.data}))\r\n//     .catch(err => console.error(err))\r\n\r\nexport const setIndexStatusActions = key => dispatch => client.call({ uri: `/elasticsearch/_cat/indices?format=json` })\r\n  .then(response => dispatch({ type: SET_INDEX_STATUS, payload: response.data }))\r\n  .catch(err => console.error(err))\r\n\r\n\r\nexport const setIndexAliasActions = key => dispatch => client.call({ uri: `/elasticsearch/_cat/aliases?format=json` })\r\n  .then(response => dispatch({ type: SET_INDEX_ALIAS, payload: response.data }))\r\n  .catch(err => console.error(err))\r\n\r\nexport const setRunningIndexActions = key => dispatch => client.call({ uri: `/dashboard/indexing` })\r\n  .then(response => dispatch({ type: SET_RUNNING_INDEX, payload: response.data }))\r\n  .catch(err => console.error(err))\r\n\r\nexport const setIndicesActions = () => dispatch =>\r\n  client.call({\r\n    uri: `/elasticsearch/_cat/indices`,\r\n    params: {\r\n      format: \"json\",\r\n    }\r\n  })\r\n    .then(response => dispatch({ type: SET_DASHBOARD_INDICES_INFO, payload: response.data }))\r\n    .catch(error => console.error(error))","import React, {useEffect} from \"react\";\r\nimport styled from \"styled-components\";\r\nimport {\r\n    setIndexAliasActions,\r\n    setIndexResultActions,\r\n    setIndexStatusActions,\r\n    setRunningIndexActions,\r\n    setIndicesActions\r\n} from '@actions/dashBoardActions'\r\nimport Helmet from \"react-helmet\";\r\nimport {useHistory} from \"react-router-dom\"\r\nimport {\r\n    Link,\r\n    Box,\r\n    Button,\r\n    Card as MuiCard,\r\n    CardContent,\r\n    Divider as MuiDivider,\r\n    Grid as MuiGrid,\r\n    LinearProgress,\r\n    Table,\r\n    TableBody,\r\n    TableCell as MuiTableCell,\r\n    TableHead,\r\n    TableRow as MuiTableRow,\r\n    Typography\r\n} from \"@material-ui/core\";\r\nimport {palette, sizing, spacing} from \"@material-ui/system\";\r\nimport {lighten, makeStyles, withStyles} from \"@material-ui/core/styles\";\r\nimport {connect} from \"react-redux\";\r\nimport Brightness1Icon from '@material-ui/icons/Brightness1';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    headerField: {fontSize: '1.2em', fontWeight: \"bold\"},\r\n    headerValue: {fontSize: '1.2em', fontWeight: \"bold\"},\r\n    primaryShard: {border: \"1px solid\",},\r\n    replicaShard: {border: \"1px dashed\", },\r\n    margin: {\r\n        margin: theme.spacing(1),\r\n      },\r\n    paper: {\r\n        padding: theme.spacing(2),\r\n        textAlign: 'center',\r\n        color: theme.palette.text.secondary,\r\n      },\r\n}));\r\n\r\nconst BorderLinearProgress = withStyles({\r\n    root: {\r\n      height: 10,\r\n      backgroundColor: lighten('#A9D0F5', 0.5),\r\n    },\r\n    bar: {\r\n      borderRadius: 20,\r\n      backgroundColor: '#013ADF',\r\n    },\r\n  })(LinearProgress);\r\n\r\n\r\nconst Card = styled(MuiCard)(spacing, sizing);\r\nconst Divider = styled(MuiDivider)(spacing, sizing);\r\nconst Grid = styled(MuiGrid)(spacing, sizing);\r\nconst TableRow = styled(MuiTableRow)(spacing, sizing, palette);\r\nconst TableCell = styled(MuiTableCell)`\r\n    border: 1px solid rgba(224, 224, 224, 1);\r\n    padding: 3px;\r\n`;\r\nconst Shard = styled(Button)`\r\n    min-width: 25px;\r\n    max-width: 25px;\r\n    width: 25px;\r\n    margin: 2px;\r\n    min-height: 25px;\r\n    max-height: 25px;\r\n    height: 25px;\r\n    font-size: 0.9em;\r\n    padding: 2px;\r\n`;\r\n\r\n\r\nconst idxRunning = [\r\n    {index:\"shop-c\",  docs:40000, lastIndex:\"1시간 5분\", exportDoc:200000},\r\n    {index:\"community\",  docs:16331, lastIndex:\"30분\", exportDoc:20000}\r\n]\r\n\r\n\r\nconst idxWarning = [\r\n    {status:\"yellow\", index:\"shop-a\", desc:\"레플리카 샤드 이상\"},\r\n    {status:\"red\", index:\"prod\", desc:\"프라이머리 샤드 이상\"}\r\n]\r\n\r\nconst idxResult = [\r\n    {status:\"success\", index:\"shop-a\", alias:\"shop\", lastSuccess:\"5분전\", elapsed:\"1시간 20분\", docs:140000, storage:\"530mb\"},\r\n    {status:\"fail\", index:\"shop-b\", alias:\"shop\", lastSuccess:\"56분전\", elapsed:\"1초\", docs:0, storage:\"10kb\"},\r\n]\r\n\r\nconst getFinishTime = (startTime, estimatedTime) => {\r\n    var date = new Date().getTime() - new Date(startTime).getTime();\r\n    return (date.valueOf()/ estimatedTime) * 100\r\n}\r\n\r\n\r\nconst untilTime = (time) => {\r\n    var date = new Date().getTime() - new Date(time).getTime();\r\n\r\n    var hours   = ((date / 3600) / 1000) * 60;\r\n\r\n    let h = Math.floor(hours / 60)\r\n    let m = Math.floor(hours % 60)\r\n    // var minutes = Math.ceil(((date - (hours * 3600)) / 60)/ 1000);\r\n    if(h >= 720){\r\n        let month = h / 30 / 24;\r\n        return Math.ceil(month) + \"개월\"\r\n    }else if(h >= 24){\r\n        let d = h / 24;\r\n        return  Math.ceil(d) + '일'\r\n    }else if(h !== 0 && m !== 0) {\r\n        return h+'시간 ' + m+'분'\r\n    }else if(h !== 0 && m === 0) {\r\n        return h+'시간'\r\n    }else{\r\n        return m+'분' \r\n    }\r\n}\r\n\r\nfunction numberWithCommas(num) {\r\n    if(num === undefined || num === null) return \"\";\r\n    return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n}\r\n\r\nfunction WarningIndex({status, indices}) {\r\n    const classes = useStyles();\r\n    const history = useHistory();\r\n    function moveDetail(uuid) {\r\n        history.push(`./indices/${uuid}`)\r\n    }\r\n\r\n    let list = [];\r\n    Object.values(status).map(row => {\r\n        if(row.health !== 'green'){\r\n            let uuid = \"\";\r\n            Object.values(indices).forEach(item => {\r\n                if (item.index === row.index) {\r\n                    uuid = item.uuid;\r\n                }\r\n            })\r\n            let item = row;\r\n            item.uuid = uuid;\r\n            list.push(item);\r\n        }\r\n    })\r\n\r\n    // console.log(list);\r\n\r\n    return(\r\n        <Card>\r\n            <CardContent>\r\n            <Typography variant=\"h4\" gutterBottom display=\"inline\">\r\n                주의할 인덱스\r\n            </Typography>\r\n            <br/><br/>\r\n            <Table>\r\n\r\n                <TableBody>\r\n                    {\r\n                        list.length > 0 ?\r\n                            list.map(row =>{\r\n                                return(\r\n                                    <TableRow key={row.index}>\r\n                                        <TableCell align=\"center\">\r\n                                            <Box display=\"flex\" justifyContent=\"left\" alignItems=\"center\">\r\n                                                <Brightness1Icon style={{color:row.health, marginRight:\"5px\"}} />\r\n                                                <Link style={{cursor: \"pointer\"}} onClick={() => moveDetail(row['uuid'])}>\r\n                                                    <Typography variant=\"h5\">{row.index}</Typography>\r\n                                                </Link>\r\n                                            </Box>\r\n                                        </TableCell>\r\n                                        <TableCell align=\"center\">\r\n                                            {row.health === 'yellow' ? <font color=\"orange\"> 레플리카 샤드 이상 </font> :\r\n                                                <font color=\"red\"> 프라이머리 샤드 이상 </font>}\r\n                                        </TableCell>\r\n                                    </TableRow>\r\n\r\n                                )\r\n                            })\r\n                            :\r\n                            (\r\n                                <TableRow>\r\n                                    <TableCell colSpan={2} style={{border: \"0px\"}}>\r\n                                        <Box align={\"center\"} style={{height: \"24px\"}}>\r\n                                            {/*정상*/}\r\n                                        </Box>\r\n                                    </TableCell>\r\n                                </TableRow>\r\n                            )\r\n                    }\r\n                </TableBody>\r\n            </Table>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n\r\n}\r\n\r\n\r\nfunction RunningIndex({result, running, status, indices}) {\r\n    const history = useHistory();\r\n    const classes = useStyles();\r\n    let indexMap = new Map()\r\n    let indexList = []\r\n    let successIndexList = {};\r\n\r\n    const getElapsed = time => {\r\n        // epoch_millis to epoch_seconds\r\n        time = time / 1000;\r\n\r\n        var hours   = Math.floor(time / 3600);\r\n        var minutes = Math.ceil((time - (hours * 3600)) / 60);\r\n        \r\n        if(hours !== 0) {\r\n            return hours+'시간 ' + minutes+'분' \r\n        }else{\r\n            return minutes+'분' \r\n        }\r\n    }\r\n\r\n    if(result.hits.hits.length >= 0){\r\n        for(let item of result.hits.hits){\r\n            successIndexList[item._source.index] = item._source;\r\n        }\r\n    }\r\n\r\n    let keyList = Object.keys(running);\r\n    if (keyList.length !== 0) {\r\n        for (let key of keyList) {\r\n            let server = running[key].server;\r\n\r\n            if(server !== undefined){\r\n                let uuid = \"\";\r\n                Object.values(indices).forEach(item => {\r\n                    if (item.index === server.index) {\r\n                        uuid = item.uuid;\r\n                    }\r\n                })\r\n\r\n                if( successIndexList[server.index] !== undefined\r\n                    && successIndexList[server.index].endTime !== undefined \r\n                    && successIndexList[server.index].startTime !== undefined\r\n                    && successIndexList[server.index].docSize !== undefined){\r\n                    \r\n                    let estimatedTime = successIndexList[server.index].endTime - successIndexList[server.index].startTime;\r\n                    let docSize = successIndexList[server.index].docSize;\r\n                    \r\n                    getFinishTime(server.startTime, estimatedTime);\r\n                    indexList.push({startTime: server.startTime, index: server.index, estimatedTime: estimatedTime, docSize: docSize, uuid : uuid});\r\n                }else{\r\n                    indexList.push({startTime: server.startTime, index: server.index, uuid: uuid});\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    function moveDetail(uuid) {\r\n        history.push(`./indices/${uuid}`)\r\n    }\r\n    \r\n    return(\r\n        <Card>\r\n            <CardContent>\r\n            <Typography variant=\"h4\" gutterBottom display=\"inline\">\r\n                전체색인 실행중\r\n            </Typography>\r\n            <br/><br/>\r\n            <Table>\r\n                <TableBody>\r\n                    {indexList.length === 0 ? <TableRow><TableCell align=\"center\"> <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\"> <Typography>현재 실행중인 색인 작업이 없습니다.</Typography></Box>  </TableCell></TableRow> : \r\n                        Object.values(indexList).map(row =>\r\n                            <TableRow key={row.index}>\r\n                                <TableCell align=\"center\">\r\n                                    <Link style={{ cursor: \"pointer\" }} onClick={() => moveDetail(row['uuid'])}>\r\n                                        <Typography variant=\"h5\">{row.index}</Typography>\r\n                                    </Link>\r\n                                </TableCell>\r\n                                <TableCell align=\"center\">\r\n                                    <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\">\r\n                                        <Box width=\"100%\" mr={1}>\r\n                                            <BorderLinearProgress\r\n                                                className={classes.margin}\r\n                                                variant=\"determinate\"\r\n                                                color=\"secondary\"\r\n                                                value={Number(getFinishTime(row.startTime, row.estimatedTime))}\r\n                                                // value={Number(`${Math.round( (untilTime(row.startTime) / getElapsed(row.estimatedTime))*100)}`)}\r\n                                            />\r\n                                        </Box>\r\n                                        <Box minWidth={15}>\r\n                                            <Typography variant=\"body2\" color=\"textSecondary\"> </Typography>\r\n                                        </Box>\r\n                                    </Box>\r\n                                    {row.estimatedTime !== undefined ? <> 예상 종료 시간 : {getElapsed(row.estimatedTime)} <br/> </> : <>예상 종료 시간 : - <br /></> }\r\n                                    {row.docSize !== undefined ? <> 예상 처리 문서 건수 : {row.docSize} <br/> </> : <>예상 처리 문서 건수 : - <br /></> }\r\n                                    시작시간 : {untilTime(row.startTime)} 전 시작<br/>\r\n                                </TableCell>\r\n                            </TableRow>\r\n                        )\r\n                    }\r\n\r\n                </TableBody>\r\n            </Table>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n\r\n}\r\n\r\nfunction TopArea({ result, running, status, indices}) {\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <Grid container spacing={3} >\r\n            <Grid item xs={6}>\r\n                <RunningIndex result={result} running={running} status={status} indices={indices} />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n                <WarningIndex status={status} indices={indices} />\r\n            </Grid>\r\n        </Grid>\r\n    )\r\n}\r\n\r\nfunction BottomArea({result, alias, indices}) {\r\n    const history = useHistory();\r\n\r\n    const format = (time) => {\r\n        // var date = new Date(time * 1000);\r\n        var date = new Date(time);\r\n        \r\n        return date.getFullYear() + '-' +\r\n        ('0' + (date.getMonth()+1)).slice(-2)+ '-' +  \r\n        ('0' + date.getDate()).slice(-2) + ' '+\r\n        ('0'+(date.getHours())).slice(-2)+ ':'+\r\n        ('0' + (date.getMinutes())).slice(-2)+ ':'+\r\n        ('0' + (date.getSeconds())).slice(-2)\r\n    }\r\n\r\n    const getElapsed = (time) => {\r\n        // epoch_millis to epoch_seconds\r\n        time = time / 1000;\r\n\r\n        var hours   = Math.floor(time / 3600);\r\n        var minutes = Math.ceil((time - (hours * 3600)) / 60);\r\n        \r\n        if(hours !== 0) {\r\n            return hours+'시간 ' + minutes+'분' \r\n        }else{\r\n            return minutes+'분' \r\n        }\r\n    }\r\n\r\n    let resultList = []\r\n    Object.values(result.hits.hits).forEach(row => {\r\n\r\n        let aliasName = \"\"\r\n        Object.values(alias).forEach(row2 =>  {\r\n\r\n            if(row._source.index === row2.index) {\r\n                aliasName = row2.alias\r\n            }\r\n        })\r\n\r\n        let uuid = \"\"\r\n        Object.values(indices).forEach(item => {\r\n            if(item.index === row._source.index){\r\n                uuid = item.uuid;\r\n            }\r\n        })\r\n   \r\n        resultList.push(\r\n            {\r\n                index:row._source.index,\r\n                alias: aliasName,\r\n                status: row._source.status,\r\n                startTime: row._source.startTime,\r\n                endTime: row._source.endTime,\r\n                docSize: row._source.docSize,\r\n                storage: row._source.store,\r\n                uuid: uuid\r\n            }\r\n        )\r\n    })\r\n\r\n    function moveDetail(uuid) {\r\n        history.push(`./indices/${uuid}`)\r\n    }\r\n\r\n    return (\r\n        <React.Fragment>\r\n\r\n            <Card mt={2} style={{ overflow: \"auto\" }}>\r\n\r\n                <CardContent>\r\n                    <Typography variant=\"h4\" gutterBottom display=\"inline\">\r\n                        전체색인 결과\r\n                    </Typography>\r\n                    <br /> <br />\r\n                    <Table>\r\n                        <TableHead>\r\n                            <TableRow>\r\n                                <TableCell align=\"center\">색인 결과</TableCell>\r\n                                <TableCell align=\"center\">인덱스</TableCell>\r\n                                <TableCell align=\"center\">별칭</TableCell>\r\n                                <TableCell align=\"center\">최근 성공</TableCell>\r\n                                <TableCell align=\"center\">소요 시간</TableCell>\r\n                                <TableCell align=\"center\">문서수</TableCell>\r\n                                <TableCell align=\"center\">스토리지 용량</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableBody>\r\n\r\n                            {resultList.length === 0 ? <TableRow><TableCell colSpan={7} align=\"center\"> <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\"> <Typography>전체 색인 결과가 없습니다.</Typography></Box> </TableCell></TableRow> : \r\n                            Object.values(resultList).map(row => {\r\n                                return (\r\n                                    <TableRow key={row.index}>\r\n                                        <TableCell align=\"center\">\r\n                                            <Box display=\"flex\" justifyContent=\"left\" alignItems=\"center\">\r\n                                                {\r\n                                                    row['status'] && row['status'] === 'SUCCESS' ?\r\n                                                        <Brightness1Icon color=\"primary\"/>\r\n                                                        :\r\n                                                        <Brightness1Icon style={{color: 'red'}}/>\r\n                                                }\r\n                                                <Typography style={{marginLeft: \"5px\"}} >{row['status']}</Typography>\r\n                                            </Box>\r\n                                        </TableCell>\r\n                                        <TableCell align=\"center\">\r\n                                            <Link style={{cursor: \"pointer\"}} onClick={() => moveDetail(row['uuid'])}>\r\n                                                <Typography variant=\"h5\">{row.index}</Typography>\r\n                                            </Link>\r\n                                        </TableCell>\r\n                                        <TableCell align=\"center\">\r\n                                            {row.alias}\r\n                                        </TableCell>\r\n                                        <TableCell align=\"center\">\r\n                                            <b>{untilTime(row.endTime)} 전 </b><br/>\r\n                                            {format(row.endTime)}\r\n                                        </TableCell>\r\n                                        <TableCell align=\"center\">\r\n                                            {getElapsed(row.endTime - row.startTime)}\r\n                                        </TableCell>\r\n                                        <TableCell align=\"center\">\r\n                                            {numberWithCommas(row.docSize)}\r\n                                        </TableCell>\r\n                                        <TableCell align=\"center\">\r\n                                            {row.storage}\r\n                                        </TableCell>\r\n                                    </TableRow>\r\n                                )\r\n                            })\r\n                            }\r\n                        </TableBody>\r\n                    </Table>\r\n                </CardContent>\r\n            </Card>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nfunction DashBoard({dispatch, result, running, status, alias, indices}) {\r\n    const classes = useStyles();\r\n\r\n    useEffect(() => {\r\n        dispatch(setIndexResultActions())\r\n        setInterval(()=>{dispatch(setIndexResultActions());}, 1000 * 60 * 3);\r\n        dispatch(setRunningIndexActions())\r\n        dispatch(setIndexStatusActions())\r\n        dispatch(setIndexAliasActions())\r\n        dispatch(setIndicesActions());\r\n    }, [])\r\n    \r\n    return (\r\n        <React.Fragment>\r\n            <Helmet title=\"대시보드\"/>\r\n\r\n            <Typography variant=\"h3\" gutterBottom display=\"inline\"> 대시보드 </Typography>\r\n\r\n            <Divider my={6} />\r\n            <TopArea result={result} running={running} status={status} indices={indices}/>\r\n            <BottomArea result={result} alias={alias} status={status} indices={indices} />\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport default connect(store => ({\r\n    result: store.dashBoardReducers.result,\r\n    running: store.dashBoardReducers.running,\r\n    status: store.dashBoardReducers.status,\r\n    alias: store.dashBoardReducers.alias,\r\n    indices: store.dashBoardReducers.indices\r\n}))(DashBoard);\r\n"],"sourceRoot":""}